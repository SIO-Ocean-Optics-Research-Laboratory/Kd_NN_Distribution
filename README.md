# Kd_NN_Distribution
---
An implementation of the neural net created by Cedric Jamet for estimating the K<sub>d</sub> values at any wavelength. The model produces K<sub>d</sub> from 412 to 670 nm, using input R<sub>rs</sub> at MODIS wavelengths (443 nm, 488 nm, 531 nm, 547 nm, 667 nm). The software is incorporated in the Loisel and Stramski 2 (LS2) model to provide K<sub>d</sub>(位) values. The complete development and validation of the Kd NN model is described in [Jamet et al. 2012](https://doi.org/10.1029/2012JC008076) and updated in [Loisel et al. 2018](https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2017JC013632) and [Jorge et al. 2021](https://doi.org/10.1016/j.rse.2021.112537). In correspondance with our collaborators we have converted Kd NN model source code into MATLAB file format.

This README document provides infromation about the files within the Kd_NN_Distribution repository.

---

## Kd_NN.m:
Neural network model to compute the K<sub>d</sub> values at wavelength inputs, for *m* samples of R<sub>rs</sub>(位) and solar zenith angle, where 位 is at MODIS wavelengths. Returns K<sub>d</sub>(位). See supporting documentation for further details.

## Kd_NN_LUT.mat:
Look-up tables (LUTs) necessary to run Kd_NN.m. The structure contains three fields, each of which is necessary to run the neural network. See Kd_NN.m function documatation for further details about the .mat file.

## Kd_NN_test_run.m:
Script which tests the Kd NN on 1000 samples at various wavelengths within the input domain.

## Kd_NN_test_run_output.xls:
Spreadsheet containing the input and resulting output parameters obtained from the application of the Kd NN on 100 samples at various wavelengths within the input domain. The file is generated by running the Kd_NN_test_run.m script.

---

Matthew Kehrli*, Aster Taylor, Rick Reynolds & Dariusz Stramski\
*mdkehrli@ucsd.edu | mdkehrli@gmail.com\
Ocean Optics Research Laboratory, Scripps Institiution of Oceanography, University of California San Diego
